<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë§ˆì´í˜ì´ì§€</title>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 30px; }
    .section { margin-bottom: 24px; }
  </style>
</head>
<body>
  <h2>ğŸ™‹â€â™‚ï¸ ë§ˆì´í˜ì´ì§€</h2>

  <div class="section">
    <p><strong>ğŸ“§ ë¡œê·¸ì¸ëœ ì´ë©”ì¼:</strong> <span id="user-email">ë¡œë”© ì¤‘...</span></p>
  </div>

  <div class="section">
    <p><strong>ğŸ“› ë‹‰ë„¤ì„:</strong> <span id="nickname-display">ì„¤ì • ì•ˆë¨</span></p>
    <input type="text" id="nickname-input" placeholder="ë‹‰ë„¤ì„ ì…ë ¥">
    <button onclick="setNickname()">ë‹‰ë„¤ì„ ì €ì¥</button>
  </div>

  <div class="section">
    <p><strong>ğŸ± ì˜¤ëŠ˜ ê¸‰ì‹ í‰ê°€:</strong></p>
    <select id="rating">
      <option value="5">â˜…â˜…â˜…â˜…â˜…</option>
      <option value="4">â˜…â˜…â˜…â˜…â˜†</option>
      <option value="3">â˜…â˜…â˜…â˜†â˜†</option>
      <option value="2">â˜…â˜…â˜†â˜†â˜†</option>
      <option value="1">â˜…â˜†â˜†â˜†â˜†</option>
    </select>
    <button onclick="submitRating()">í‰ê°€ ì œì¶œ</button>
    <p id="rating-result" style="margin-top:10px;"></p>
  </div>

  <div class="section">
    <p><strong>â° ì•Œë¦¼ ì„¤ì •:</strong></p>
    <p>ìš”ì¼: ì›”~ê¸ˆ / ì‹œê°„: ì˜¤ì „ 8ì‹œ</p>
  </div>

  <div class="section">
    <button onclick="logout()">ğŸšª ë¡œê·¸ì•„ì›ƒ</button>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyC03AFLg_KQpTMANt5b6hfPj3pEBjo8SBs",
      authDomain: "todaymeal-1e714.firebaseapp.com",
      projectId: "todaymeal-1e714",
      storageBucket: "todaymeal-1e714.appspot.com",
      messagingSenderId: "815968093910",
      appId: "1:815968093910:web:015a59857e22478230ab77",
      measurementId: "G-XYRR36LBNS"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // âœ… ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
    auth.onAuthStateChanged((user) => {
      if (user) {
        document.getElementById("user-email").innerText = user.email;
      } else {
        alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
        window.location.href = "auth.html";
      }
    });

    // âœ… ë¡œê·¸ì•„ì›ƒ
    function logout() {
      auth.signOut().then(() => {
        alert("ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.");
        window.location.href = "auth.html";
      });
    }

    // âœ… ë‹‰ë„¤ì„ ì €ì¥ (ë¡œì»¬ì—ë§Œ ì €ì¥ë¨)
    function setNickname() {
      const nickname = document.getElementById("nickname-input").value;
      if (nickname.trim()) {
        localStorage.setItem("nickname", nickname);
        document.getElementById("nickname-display").innerText = nickname;
        alert("ë‹‰ë„¤ì„ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
      }
    }

    // âœ… í˜ì´ì§€ ë¡œë“œì‹œ ë‹‰ë„¤ì„ í‘œì‹œ
    window.onload = () => {
      const savedName = localStorage.getItem("nickname");
      if (savedName) {
        document.getElementById("nickname-display").innerText = savedName;
      }
    };

    // âœ… ê¸‰ì‹ í‰ê°€ ì œì¶œ
    function submitRating() {
      const rating = document.getElementById("rating").value;
      document.getElementById("rating-result").innerText = `ì˜¤ëŠ˜ì˜ ê¸‰ì‹ ë³„ì : ${"â˜…".repeat(rating)}${"â˜†".repeat(5 - rating)}`;
    }
  </script>
</body>
</html>
